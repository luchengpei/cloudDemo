(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["bbs/topic/add"],{"15b9":function(t,e,n){"use strict";(function(t,o){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;i(n("7ec9"));function i(t){return t&&t.__esModule?t:{default:t}}var u=function(){Promise.all([n.e("common/vendor"),n.e("components/upimgbox")]).then(function(){return resolve(n("1208"))}.bind(null,n)).catch(n.oe)},s=function(){n.e("components/footer").then(function(){return resolve(n("c63d"))}.bind(null,n)).catch(n.oe)},c={components:{mtFooter:s,upimgBox:u},data:function(){return{unLogin:!0,ssuserid:"",imgsList:[],list:[{cate_name:"发布帖子"},{cate_name:"发布视频"}],current:0,video:{content:"",video_src:"",video_img:"",love_num:0,comm_num:0,redo_num:0,add_time:"",update_time:"",userid:"",status:1},srcVideo:"",videoShow:!0,confirmShow:!1,confirmContent:"",show:!1,progress:0}},onLoad:function(){this.getPage()},methods:{change:function(t){this.current=t},chooseVideo:function(){var e=this;t.chooseVideo({maxDuration:60,count:1,camera:"back",sourceType:["album","camera"],success:function(t){e.srcVideo=t.tempFilePath,e.confirmShow=!0,e.confirmContent="是否上传视频？"}})},confirm:function(){this.videoShow=!1,this.show=!0,this.progress=0;var t=this,e=this.srcVideo;o.uploadFile({filePath:e,cloudPath:Date.now()+".mp4",dataType:"json",onUploadProgress:function(e){t.progress=e.loaded/e.total*100},success:function(e){1==e.success&&(t.show=!1,t.video.video_src=e.fileID,t.$refs.uToast.show({title:"上传视频成功！",type:"success",icon:!0,duration:2e3}))}})},Submit:function(){""!=this.video.content&&""!=this.video.video_src?(this.video.add_time=(new Date).Format("yyyy-MM-dd hh:mm:ss"),this.video.userid=this.ssuserid,o.callFunction({name:"videoList",data:{action:"add",params:this.video}}).then((function(e){t.showToast({title:"发布成功"}),t.reLaunch({url:"/pages/video/index"})})).catch((function(t){console.error(t)}))):t.showToast({title:"内容未填或视频未上传成功！",icon:"none"})},delectVideo:function(){this.video.video_src="",this.videoShow=!0},callImgList:function(t){this.imgsList=t},getPage:function(){if(this.ssuserid=getApp().globalData.ssuserid,this.unLogin=getApp().globalData.unLogin,""==this.ssuserid)return!1},formSubmit:function(e){var n=e.detail.value;""!=n.title&&""!=n.content&&0!=this.imgsList.length?(n.createTime=(new Date).Format("yyyy-MM-dd hh:mm:ss"),n.imgList=this.imgsList,n.userid=this.ssuserid,n.love_num=0,n.view_num=1,n.comment_num=0,n.status=0,o.callFunction({name:"bbs_topic",data:{cloudAction:"save",params:n}}).then((function(e){t.showToast({title:"发布成功"}),t.reLaunch({url:"/pages/index/index"})})).catch((function(t){console.error(t)}))):t.showToast({title:"标题、内容必填，图片至少上传一张！",icon:"none"})}}};e.default=c}).call(this,n("543d")["default"],n("a9ff")["default"])},2727:function(t,e,n){"use strict";(function(t){n("7d33");o(n("66fd"));var e=o(n("a15c"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},a15c:function(t,e,n){"use strict";n.r(e);var o=n("f33a"),i=n("a796");for(var u in i)"default"!==u&&function(t){n.d(e,t,(function(){return i[t]}))}(u);var s,c=n("f0c5"),a=Object(c["a"])(i["default"],o["b"],o["c"],!1,null,"79f36a4c",null,!1,o["a"],s);e["default"]=a.exports},a796:function(t,e,n){"use strict";n.r(e);var o=n("15b9"),i=n.n(o);for(var u in o)"default"!==u&&function(t){n.d(e,t,(function(){return o[t]}))}(u);e["default"]=i.a},f33a:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return u})),n.d(e,"a",(function(){return o}));var o={uTabs:function(){return Promise.all([n.e("common/vendor"),n.e("uview-ui/components/u-tabs/u-tabs")]).then(n.bind(null,"3376"))},uGap:function(){return n.e("uview-ui/components/u-gap/u-gap").then(n.bind(null,"51e4"))},uModal:function(){return n.e("uview-ui/components/u-modal/u-modal").then(n.bind(null,"db1f"))},uToast:function(){return n.e("uview-ui/components/u-toast/u-toast").then(n.bind(null,"7c48"))},uPopup:function(){return n.e("uview-ui/components/u-popup/u-popup").then(n.bind(null,"1c15"))},uLineProgress:function(){return n.e("uview-ui/components/u-line-progress/u-line-progress").then(n.bind(null,"6b83"))}},i=function(){var t=this,e=t.$createElement;t._self._c},u=[]}},[["2727","common/runtime","common/vendor"]]]);